<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="prev" title="Greedy Coalition Method" href="3_subset_finding_tutorial.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2023.07.26 -->
        <title>&lt;no title&gt; - [SEP_SoSe2025 / Gruppe C] Game Theoretic Explainable Artificial Intelligence</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">[SEP_SoSe2025 / Gruppe C] Game Theoretic Explainable Artificial Intelligence</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/SEP_Logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">[SEP_SoSe2025 / Gruppe C] Game Theoretic Explainable Artificial Intelligence</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules.html">shapiq_student</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of shapiq_student</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../shapiq_student.html">shapiq_student package</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="1.1_1.3_basic_and_weighted_KNN_tutorial.html">KNN-Shapley Explainer Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.2_threshold_KNN_tutorial.html">Threshold KNN‑Shapley Explainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.1_gaussian_imputer_tutorial.html">Gaussian Conditional Imputer</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.2_gaussian_copula_tutorial.html">Gaussian Copula Imputer</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_subset_finding_tutorial.html">Greedy Coalition Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_subset_finding_tutorial.html#beam-search-coalition-method">Beam Search Coalition Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_subset_finding_tutorial.html#beam-search-coalition-method-with-specified-beam-width">Beam Search Coalition Method with specified beam_width</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_subset_finding_tutorial.html#recursive-greedy-algorithm">Recursive greedy algorithm</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shapiq</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn.ensemble</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">x_bike_sharing</span><span class="p">,</span> <span class="n">y_bike_sharing</span>  <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_bike_sharing</span><span class="p">(</span><span class="n">to_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_california_housing</span><span class="p">,</span> <span class="n">y_california_housing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_california_housing</span><span class="p">(</span><span class="n">to_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">model_bike_sharing</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">()</span>
<span class="n">model_california_housing</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">()</span>

<span class="n">x_bike_sharing_train</span><span class="p">,</span> <span class="n">x_bike_sharing_test</span><span class="p">,</span> <span class="n">y_bike_sharing_train</span><span class="p">,</span> <span class="n">y_bike_sharing_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x_bike_sharing</span><span class="p">,</span><span class="n">y_bike_sharing</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">x_california_housing_train</span><span class="p">,</span> <span class="n">x_california_housing_test</span><span class="p">,</span> <span class="n">y_california_housing_train</span><span class="p">,</span> <span class="n">y_california_housing_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x_california_housing</span><span class="p">,</span><span class="n">y_california_housing</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">model_bike_sharing</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_bike_sharing_train</span><span class="p">,</span><span class="n">y_bike_sharing_train</span><span class="p">)</span>
<span class="n">model_california_housing</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_california_housing_train</span><span class="p">,</span><span class="n">y_california_housing_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">shapiq</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">sklearn</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">shapiq</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">10</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.3.1&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># approximator classes</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.approximator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">SHAPIQ</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">SPEX</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="n">SVARM</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="n">SVARMIQ</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">InconsistentKernelSHAPIQ</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>     <span class="n">KernelSHAP</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span>     <span class="n">KernelSHAPIQ</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="n">OwenSamplingSV</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span>     <span class="n">PermutationSamplingSII</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span>     <span class="n">PermutationSamplingSTII</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="n">PermutationSamplingSV</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="n">RegressionFBII</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span>     <span class="n">RegressionFSII</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="n">StratifiedSamplingSV</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span>     <span class="n">UnbiasedKernelSHAP</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span>     <span class="n">kADDSHAP</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.benchmark</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span>     <span class="n">BENCHMARK_CONFIGURATIONS</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span>     <span class="n">GAME_CLASS_TO_NAME_MAPPING</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span>     <span class="n">run_benchmark_from_configuration</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="c1"># dataset functions</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">shapiq</span><span class="o">/</span><span class="n">approximator</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">17</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.permutation.sv</span><span class="w"> </span><span class="kn">import</span> <span class="n">PermutationSamplingSV</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.regression</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="n">InconsistentKernelSHAPIQ</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">KernelSHAP</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">kADDSHAP</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">17</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">SPEX</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="c1"># contains all SV approximators</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="n">SV_APPROXIMATORS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Approximator</span><span class="o">.</span><span class="vm">__class__</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="n">OwenSamplingSV</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="n">StratifiedSamplingSV</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span>     <span class="n">SPEX</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="p">]</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">shapiq</span><span class="o">/</span><span class="n">approximator</span><span class="o">/</span><span class="n">sparse</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Sparse fourier-based approximators for higher-order interactions.&quot;&quot;&quot;</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sparse</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.spex</span><span class="w"> </span><span class="kn">import</span> <span class="n">SPEX</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="s2">&quot;SPEX&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="s2">&quot;Sparse&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="p">]</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">shapiq</span><span class="o">/</span><span class="n">approximator</span><span class="o">/</span><span class="n">sparse</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">get_args</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sparse_transform.qsft.qsft</span><span class="w"> </span><span class="kn">import</span> <span class="n">transform</span> <span class="k">as</span> <span class="n">sparse_fourier_transform</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sparse_transform.qsft.signals.input_signal_subsampled</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">SubsampledSignal</span> <span class="k">as</span> <span class="n">SubsampledSignalFourier</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sparse_transform.qsft.utils.general</span><span class="w"> </span><span class="kn">import</span> <span class="n">fourier_to_mobius</span> <span class="k">as</span> <span class="n">fourier_to_moebius</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sparse_transform</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sparse_transform.qsft</span><span class="w"> </span><span class="kn">import</span> <span class="n">qsft</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Package-level logger</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sparse_transform</span><span class="o">/</span><span class="n">qsft</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">qsft</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="s2">&quot;qsft&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="p">]</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sparse_transform</span><span class="o">/</span><span class="n">qsft</span><span class="o">/</span><span class="n">qsft</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">10</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">,</span> <span class="n">LassoCV</span><span class="p">,</span> <span class="n">OrthogonalMatchingPursuit</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sparse_transform.qsft.utils.reconstruct</span><span class="w"> </span><span class="kn">import</span> <span class="n">singleton_detection</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sparse_transform.qsft.utils.general</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">qary_vec_to_dec</span><span class="p">,</span> <span class="n">sort_qary_vecs</span><span class="p">,</span> <span class="n">calc_hamming_weight</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>                                                   <span class="n">dec_to_qary_vec</span><span class="p">,</span> <span class="n">qary_ints_low_order</span><span class="p">)</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">73</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="c1"># `_distributor_init` allows distributors to run custom init code.</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> <span class="c1"># For instance, for the Windows wheel, this is used to pre-load the</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> <span class="c1"># vcomp shared library runtime for OpenMP embedded in the sklearn/.libs</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span> <span class="c1"># later is linked to the OpenMP runtime to make it possible to introspect</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span> <span class="c1"># it and importing it first would fail if the OpenMP dll cannot be found.</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>  <span class="c1"># noqa: F401 E402</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>     <span class="n">__check_build</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span>     <span class="n">_distributor_init</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">73</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">clone</span>  <span class="c1"># noqa: E402</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.utils._show_versions</span><span class="w"> </span><span class="kn">import</span> <span class="n">show_versions</span>  <span class="c1"># noqa: E402</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="n">_submodules</span> <span class="o">=</span> <span class="p">[</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span>     <span class="s2">&quot;calibration&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>     <span class="s2">&quot;cluster&quot;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>     <span class="s2">&quot;compose&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="p">]</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">19</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="kn">from</span><span class="w"> </span><span class="nn">._config</span><span class="w"> </span><span class="kn">import</span> <span class="n">config_context</span><span class="p">,</span> <span class="n">get_config</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">InconsistentVersionWarning</span>
<span class="ne">---&gt; </span><span class="mi">19</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.utils._metadata_requests</span><span class="w"> </span><span class="kn">import</span> <span class="n">_MetadataRequester</span><span class="p">,</span> <span class="n">_routing_enabled</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.utils._missing</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_scalar_nan</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.utils._param_validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate_parameter_constraints</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">metadata_routing</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span><span class="w"> </span><span class="nn">._bunch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bunch</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="kn">from</span><span class="w"> </span><span class="nn">._chunking</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_batches</span><span class="p">,</span> <span class="n">gen_even_slices</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="c1"># Make _safe_indexing importable from here for backward compat as this particular</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="c1"># helper is considered semi-private and typically very useful for third-party</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="c1"># libraries that want to comply with scikit-learn&#39;s estimator API. In particular,</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="c1"># _safe_indexing was included in our public API documentation despite the leading</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="c1"># `_` in its name.</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="kn">from</span><span class="w"> </span><span class="nn">._indexing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span>     <span class="n">_safe_indexing</span><span class="p">,</span>  <span class="c1"># noqa: F401</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="n">resample</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span>     <span class="n">shuffle</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="p">)</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">_chunking</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">11</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.._config</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_config</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span><span class="w"> </span><span class="nn">._param_validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">validate_params</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="k">def</span><span class="w"> </span><span class="nf">chunk_generator</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Chunk generator, ``gen`` into lists of length ``chunksize``. The last</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span><span class="sd">     chunk may have a length less than ``chunksize``.&quot;&quot;&quot;</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">_param_validation</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">17</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">csr_matrix</span><span class="p">,</span> <span class="n">issparse</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.._config</span><span class="w"> </span><span class="kn">import</span> <span class="n">config_context</span><span class="p">,</span> <span class="n">get_config</span>
<span class="ne">---&gt; </span><span class="mi">17</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">_is_arraylike_not_scalar</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="k">class</span><span class="w"> </span><span class="nc">InvalidParameterError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Custom exception to be raised when the parameter of a class/method/function</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span><span class="sd">     does not have a valid type or value.</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span><span class="sd">     &quot;&quot;&quot;</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">validation</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">21</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="kn">from</span><span class="w"> </span><span class="nn">..</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_config</span> <span class="k">as</span> <span class="n">_get_config</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="kn">from</span><span class="w"> </span><span class="nn">..exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataConversionWarning</span><span class="p">,</span> <span class="n">NotFittedError</span><span class="p">,</span> <span class="n">PositiveSpectrumWarning</span>
<span class="ne">---&gt; </span><span class="mi">21</span> <span class="kn">from</span><span class="w"> </span><span class="nn">..utils._array_api</span><span class="w"> </span><span class="kn">import</span> <span class="n">_asarray_with_order</span><span class="p">,</span> <span class="n">_is_numpy_namespace</span><span class="p">,</span> <span class="n">get_namespace</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span> <span class="kn">from</span><span class="w"> </span><span class="nn">..utils.deprecation</span><span class="w"> </span><span class="kn">import</span> <span class="n">_deprecate_force_all_finite</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="kn">from</span><span class="w"> </span><span class="nn">..utils.fixes</span><span class="w"> </span><span class="kn">import</span> <span class="n">ComplexWarning</span><span class="p">,</span> <span class="n">_preserve_dia_indices_dtype</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">_array_api</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">20</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="kn">from</span><span class="w"> </span><span class="nn">..externals</span><span class="w"> </span><span class="kn">import</span> <span class="n">array_api_extra</span> <span class="k">as</span> <span class="n">xpx</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="kn">from</span><span class="w"> </span><span class="nn">..externals.array_api_compat</span><span class="w"> </span><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np_compat</span>
<span class="ne">---&gt; </span><span class="mi">20</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.fixes</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_version</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span> <span class="c1"># TODO: complete __all__</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xpx&quot;</span><span class="p">]</span>  <span class="c1"># we import xpx here just to re-export it, need this to appease ruff</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">sklearn</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">fixes</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">20</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">20</span>     <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="n">pd</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">22</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="k">del</span> <span class="n">_hard_dependencies</span><span class="p">,</span> <span class="n">_dependency</span><span class="p">,</span> <span class="n">_missing_dependencies</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="c1"># numpy compat</span>
<span class="ne">---&gt; </span><span class="mi">22</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.compat</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_numpy_dev</span> <span class="k">as</span> <span class="n">_is_numpy_dev</span>  <span class="c1"># pyright: ignore # noqa:F401</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span>     <span class="kn">from</span><span class="w"> </span><span class="nn">pandas._libs</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashtable</span> <span class="k">as</span> <span class="n">_hashtable</span><span class="p">,</span> <span class="n">lib</span> <span class="k">as</span> <span class="n">_lib</span><span class="p">,</span> <span class="n">tslib</span> <span class="k">as</span> <span class="n">_tslib</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">compat</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">25</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.compat._constants</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="n">IS64</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span>     <span class="n">PY39</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="n">PYPY</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas.compat.compressors</span>
<span class="ne">---&gt; </span><span class="mi">25</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.compat.numpy</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span>     <span class="n">is_numpy_dev</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span>     <span class="n">np_version_under1p21</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.compat.pyarrow</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span>     <span class="n">pa_version_under7p0</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="n">pa_version_under8p0</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>     <span class="n">pa_version_under9p0</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>     <span class="n">pa_version_under11p0</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_function_name</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">compat</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span><span class="w"> </span><span class="sd">&quot;&quot;&quot; support numpy compatibility across versions &quot;&quot;&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.util.version</span><span class="w"> </span><span class="kn">import</span> <span class="n">Version</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># numpy versioning</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">_np_version</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># pyright: reportUnusedImport = false</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.util._decorators</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>  <span class="c1"># noqa:F401</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">Appender</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">Substitution</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">cache_readonly</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.core.util.hashing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>  <span class="c1"># noqa:F401</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="n">hash_array</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="n">hash_pandas_object</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="p">)</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">_decorators</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">14</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">Any</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="n">Callable</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="n">Mapping</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="n">cast</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="ne">---&gt; </span><span class="mi">14</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas._libs.properties</span><span class="w"> </span><span class="kn">import</span> <span class="n">cache_readonly</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas._typing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>     <span class="n">F</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span>     <span class="n">T</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.util._exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_stack_level</span>

<span class="n">File</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">homebrew</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">_libs</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">13</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="s2">&quot;NaT&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="s2">&quot;NaTType&quot;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="s2">&quot;Interval&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas._libs.interval</span><span class="w"> </span><span class="kn">import</span> <span class="n">Interval</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pandas._libs.tslibs</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">NaT</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>     <span class="n">NaTType</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="n">iNaT</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span> <span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.11/site-packages/pandas/_libs/interval.pyx:1,</span> in <span class="ni">init pandas._libs.interval</span><span class="nt">()</span>

<span class="ne">ValueError</span>: numpy.dtype size changed, may indicate binary incompatibility. Expected 96 from C header, got 88 from PyObject
</pre></div>
</div>
</div>
</div>
<p>Training a Random Forest Regression model on both datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputer</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;marginal&quot;</span><span class="p">,</span> <span class="s2">&quot;conditional&quot;</span><span class="p">]</span>

<span class="n">SVARM_bike_sharing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">approximator</span><span class="o">.</span><span class="n">SVARM</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">x_bike_sharing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">PermutationSamplingSV_bike_sharing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">approximator</span><span class="o">.</span><span class="n">PermutationSamplingSV</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">x_bike_sharing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">KernelSHAP_bike_sharing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">approximator</span><span class="o">.</span><span class="n">KernelSHAP</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">x_bike_sharing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">SVARM_california_housing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">approximator</span><span class="o">.</span><span class="n">SVARM</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">x_california_housing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">PermutationSamplingSV_california_housing</span><span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">approximator</span><span class="o">.</span><span class="n">PermutationSamplingSV</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">x_california_housing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">KernelSHAP_california_housing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">approximator</span><span class="o">.</span><span class="n">KernelSHAP</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">x_california_housing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">approximators_california_housing</span> <span class="o">=</span> <span class="p">(</span><span class="n">SVARM_california_housing</span><span class="p">,</span><span class="n">PermutationSamplingSV_california_housing</span><span class="p">,</span><span class="n">KernelSHAP_california_housing</span><span class="p">)</span>
<span class="n">approximators_bike_sharing</span> <span class="o">=</span> <span class="p">(</span><span class="n">SVARM_bike_sharing</span><span class="p">,</span><span class="n">PermutationSamplingSV_bike_sharing</span><span class="p">,</span><span class="n">KernelSHAP_bike_sharing</span><span class="p">)</span>

<span class="n">explainers_california_housing</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">games_california_housing</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">explainers_bike_sharing</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">games_bike_sharing</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">imp</span> <span class="ow">in</span> <span class="n">imputer</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">app</span> <span class="ow">in</span> <span class="n">approximators_bike_sharing</span><span class="p">:</span>
        <span class="n">explainers_bike_sharing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapiq</span><span class="o">.</span><span class="n">explainer</span><span class="o">.</span><span class="n">tabular</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_bike_sharing</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">x_bike_sharing_test</span><span class="p">,</span> <span class="n">imputer</span><span class="o">=</span><span class="n">imp</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="n">app</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">app</span> <span class="ow">in</span> <span class="n">approximators_california_housing</span><span class="p">:</span>
        <span class="n">explainers_california_housing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapiq</span><span class="o">.</span><span class="n">explainer</span><span class="o">.</span><span class="n">tabular</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_california_housing</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">x_california_housing_test</span><span class="p">,</span> <span class="n">imputer</span><span class="o">=</span><span class="n">imp</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="n">app</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">exact_computer_california_housing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">ExactComputer</span><span class="p">(</span><span class="n">x_california_housing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">game</span><span class="o">=</span><span class="n">shapiq</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">local_xai</span><span class="o">.</span><span class="n">benchmark_tabular</span><span class="o">.</span><span class="n">CaliforniaHousing</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_california_housing_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="n">imputer</span><span class="o">=</span><span class="n">imp</span><span class="p">))</span>
        <span class="n">games_california_housing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exact_computer_california_housing</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;SV&quot;</span><span class="p">))</span>
        <span class="n">exact_computer_bike_sharing</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">ExactComputer</span><span class="p">(</span><span class="n">x_bike_sharing</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">game</span><span class="o">=</span><span class="n">shapiq</span><span class="o">.</span><span class="n">games</span><span class="o">.</span><span class="n">benchmark</span><span class="o">.</span><span class="n">local_xai</span><span class="o">.</span><span class="n">benchmark_tabular</span><span class="o">.</span><span class="n">BikeSharing</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_bike_sharing_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;random_forest&quot;</span><span class="p">,</span> <span class="n">imputer</span><span class="o">=</span><span class="n">imp</span><span class="p">))</span>
        <span class="n">games_bike_sharing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exact_computer_bike_sharing</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;SV&quot;</span><span class="p">))</span>  
</pre></div>
</div>
</div>
</div>
<p>Creating explainer objects for all combinations of imputers and approximators given in the task.</p>
<p>Also computing the exact InteractionValue for the first 50 intances of the test sets. Storing the values for the marginal Imputer in the first 50 entries to the games list and the values for the conditional Imputer in the last 50.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">first_50_vals_california_housing</span><span class="p">(</span><span class="n">explainer</span><span class="p">):</span>
    <span class="n">imp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">explainers_california_housing</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">imp</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">runtimes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">sv_exact</span> <span class="o">=</span> <span class="n">games_california_housing</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">imp</span><span class="p">]</span>
        <span class="n">sv_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">explain_function</span><span class="p">(</span><span class="n">x_california_housing_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">budget</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">sv_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">runtimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sv_end</span><span class="o">-</span><span class="n">sv_start</span><span class="p">)</span>
        <span class="n">sv_exact</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">sv_exact</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">errors</span><span class="p">,</span><span class="n">runtimes</span>

<span class="k">def</span><span class="w"> </span><span class="nf">first_50_vals_bike_sharing</span><span class="p">(</span><span class="n">explainer</span><span class="p">):</span>
    <span class="n">imp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">explainers_bike_sharing</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">imp</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">runtimes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">sv_exact</span> <span class="o">=</span> <span class="n">games_bike_sharing</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">imp</span><span class="p">]</span>
        <span class="n">sv_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">explain_function</span><span class="p">(</span><span class="n">x_bike_sharing_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">budget</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">sv_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">runtimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sv_end</span><span class="o">-</span><span class="n">sv_start</span><span class="p">)</span>
        <span class="n">sv_exact</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">sv_exact</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">errors</span><span class="p">,</span><span class="n">runtimes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors_california_housing</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runtimes_california_housing</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">errors_bike_sharing</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runtimes_bike_sharing</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">explainer</span> <span class="ow">in</span> <span class="n">explainers_california_housing</span><span class="p">:</span>
    <span class="n">errors</span><span class="p">,</span> <span class="n">runtimes</span> <span class="o">=</span> <span class="n">first_50_vals_california_housing</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span>
    <span class="n">errors_california_housing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
    <span class="n">runtimes_california_housing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runtimes</span><span class="p">)</span>

<span class="k">for</span> <span class="n">explainer</span> <span class="ow">in</span> <span class="n">explainers_bike_sharing</span><span class="p">:</span>
    <span class="n">errors</span><span class="p">,</span> <span class="n">runtimes</span> <span class="o">=</span> <span class="n">first_50_vals_bike_sharing</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span>
    <span class="n">errors_bike_sharing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
    <span class="n">runtimes_bike_sharing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runtimes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Computing the InteractionValues for the first 50 instances of the test sets and calculating the mean squared error in comparison to the before calculated exact values for every combination of approximators and imputers. The imputer used in each explainer is derived from its position in the explainers list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">bike_sharing_predict</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">model_bike_sharing</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">california_housing_predict</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">model_california_housing</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">independent_masker_bike_sharing</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">maskers</span><span class="o">.</span><span class="n">Independent</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_bike_sharing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">independent_masker_california_housing</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">maskers</span><span class="o">.</span><span class="n">Independent</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_california_housing</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>

<span class="n">partition_masker_bike_sharing</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">maskers</span><span class="o">.</span><span class="n">Partition</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_bike_sharing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">partition_masker_california_housing</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">maskers</span><span class="o">.</span><span class="n">Partition</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_california_housing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>

<span class="n">explainers_california_housing_shap</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">explainers_bike_sharing_shap</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">explainers_bike_sharing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">bike_sharing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">independent_masker_bike_sharing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_bike_sharing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="n">explainers_california_housing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">california_housing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">independent_masker_california_housing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_california_housing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="n">explainers_bike_sharing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">bike_sharing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">partition_masker_bike_sharing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_bike_sharing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="n">explainers_california_housing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">california_housing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">partition_masker_california_housing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_california_housing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="n">explainers_bike_sharing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">PermutationExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">bike_sharing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">independent_masker_bike_sharing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_bike_sharing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="n">explainers_california_housing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">PermutationExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">california_housing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">independent_masker_california_housing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_california_housing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="n">explainers_bike_sharing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">PermutationExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">bike_sharing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">partition_masker_bike_sharing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_bike_sharing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="n">explainers_california_housing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">PermutationExplainer</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">california_housing_predict</span><span class="p">,</span><span class="n">masker</span><span class="o">=</span><span class="n">partition_masker_california_housing</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">shap</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x_california_housing_train</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>Initializing explainer objects with shap using the independent and partition maskers. Independent masker will be compared to the marginal Imputer, partition masker to the Conditional Imputer.</p>
<p>The explainers use 100 samples for computing shapley values similiar to the budget of 100 used for shapiq.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">first_50_vals_california_housing_shap</span><span class="p">(</span><span class="n">explainer</span><span class="p">):</span>
    <span class="n">imp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">explainers_california_housing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">explainers_california_housing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">imp</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">runtimes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">sv_exact</span> <span class="o">=</span> <span class="n">games_california_housing</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">imp</span><span class="p">]</span>
        <span class="n">sv_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">explainer</span><span class="p">,</span> <span class="n">shap</span><span class="o">.</span><span class="n">PermutationExplainer</span><span class="p">)):</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">x_california_housing_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">x_california_housing_test</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">sv_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">runtimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sv_end</span><span class="o">-</span><span class="n">sv_start</span><span class="p">)</span>
        <span class="n">sv_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">sv_exact</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span><span class="n">sv_exact</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">errors</span><span class="p">,</span><span class="n">runtimes</span>

<span class="k">def</span><span class="w"> </span><span class="nf">first_50_vals_bike_sharing_shap</span><span class="p">(</span><span class="n">explainer</span><span class="p">):</span>
    <span class="n">imp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">explainers_bike_sharing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">explainers_bike_sharing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">imp</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">runtimes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">sv_exact</span> <span class="o">=</span> <span class="n">games_bike_sharing</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">imp</span><span class="p">]</span>
        <span class="n">sv_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">explainer</span><span class="p">,</span> <span class="n">shap</span><span class="o">.</span><span class="n">PermutationExplainer</span><span class="p">)):</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">x_bike_sharing_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">x_bike_sharing_test</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">sv_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">runtimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sv_end</span><span class="o">-</span><span class="n">sv_start</span><span class="p">)</span>
        <span class="n">sv_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">sv_exact</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span><span class="n">sv_exact</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">errors</span><span class="p">,</span><span class="n">runtimes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors_california_housing_shap</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runtimes_california_housing_shap</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">errors_bike_sharing_shap</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runtimes_bike_sharing_shap</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">explainer</span> <span class="ow">in</span> <span class="n">explainers_bike_sharing_shap</span><span class="p">:</span>
    <span class="n">errors</span><span class="p">,</span> <span class="n">runtimes</span> <span class="o">=</span> <span class="n">first_50_vals_bike_sharing_shap</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span>
    <span class="n">errors_bike_sharing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
    <span class="n">runtimes_bike_sharing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runtimes</span><span class="p">)</span>

<span class="k">for</span> <span class="n">explainer</span> <span class="ow">in</span> <span class="n">explainers_california_housing_shap</span><span class="p">:</span>
    <span class="n">errors</span><span class="p">,</span> <span class="n">runtimes</span> <span class="o">=</span> <span class="n">first_50_vals_california_housing_shap</span><span class="p">(</span><span class="n">explainer</span><span class="p">)</span>
    <span class="n">errors_california_housing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
    <span class="n">runtimes_california_housing_shap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runtimes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Calculation the runtime and mean squared error of the first 50 instances of test split for every combination of explainer and masker.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">labels_shapiq</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SVARM Marginal&quot;</span><span class="p">,</span><span class="s2">&quot;Permutation Marginal&quot;</span><span class="p">,</span><span class="s2">&quot;Kernel Marginal&quot;</span><span class="p">,</span><span class="s2">&quot;SVARM Conditional&quot;</span><span class="p">,</span><span class="s2">&quot;Permutation Conditional&quot;</span><span class="p">,</span><span class="s2">&quot;Kernel Conditional&quot;</span><span class="p">]</span>
<span class="n">labels_shap</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Kernel Independent&quot;</span><span class="p">,</span> <span class="s2">&quot;Kernel Partition&quot;</span><span class="p">,</span> <span class="s2">&quot;Permutation Independent&quot;</span><span class="p">,</span> <span class="s2">&quot;Permutation Partition&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">,</span> <span class="n">errors_california_housing</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels_shapiq</span><span class="p">[</span><span class="n">runtimes_california_housing</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)],</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">error_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">error_list</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">labels_shapiq</span><span class="p">[</span><span class="n">runtimes_california_housing</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)]</span><span class="si">}</span><span class="s2"> average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Shapiq Errors and Runtimes on California Housing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">for</span> <span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">,</span> <span class="n">errors_bike_sharing</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels_shapiq</span><span class="p">[</span><span class="n">runtimes_bike_sharing</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)],</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">error_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">error_list</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">labels_shapiq</span><span class="p">[</span><span class="n">runtimes_bike_sharing</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)]</span><span class="si">}</span><span class="s2"> average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Shapiq Errors and Runtimes on Bike Sharing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">for</span> <span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">,</span> <span class="n">errors_california_housing_shap</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels_shap</span><span class="p">[</span><span class="n">runtimes_california_housing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)],</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">error_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">error_list</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">labels_shap</span><span class="p">[</span><span class="n">runtimes_california_housing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)]</span><span class="si">}</span><span class="s2"> average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Shap Errors and Runtimes on California Housing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">for</span> <span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">,</span> <span class="n">errors_bike_sharing_shap</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">,</span> <span class="n">error_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels_shap</span><span class="p">[</span><span class="n">runtimes_bike_sharing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)],</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">error_list</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">error_list</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">labels_shap</span><span class="p">[</span><span class="n">runtimes_bike_sharing_shap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">runtime_list</span><span class="p">)]</span><span class="si">}</span><span class="s2"> average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Shap Errors and Runtimes on Bike Sharing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d10d4f26e827ce7a05d4c363e1952f968bb84f8c9b64d0ff053721ed17fd5fb5.png" src="../_images/d10d4f26e827ce7a05d4c363e1952f968bb84f8c9b64d0ff053721ed17fd5fb5.png" />
<img alt="../_images/082e688f201423288611655018b31646bc7a8b497a7667f99748e80485b34391.png" src="../_images/082e688f201423288611655018b31646bc7a8b497a7667f99748e80485b34391.png" />
<img alt="../_images/9737857ed4383c4715602c6a8d993a4e4ce8f4f2cb2478fe8e96d9dfe4c2918e.png" src="../_images/9737857ed4383c4715602c6a8d993a4e4ce8f4f2cb2478fe8e96d9dfe4c2918e.png" />
<img alt="../_images/9491ee9c65a5ed3ad43a1ac1c2495de8a266646200cd278f45a4568f19008be4.png" src="../_images/9491ee9c65a5ed3ad43a1ac1c2495de8a266646200cd278f45a4568f19008be4.png" />
</div>
</div>
<p>Visualizing Runtimes and Error for every combination of Approximator and Imputer for both shapiq and shap on each dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Kernel marginal shapiq to Kernel independent shap on Bike Sharing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Kernel marginal shapiq to Kernel independent shap on California Housing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/79b8657181f4c5b86e411f451ea87762a435d4ca7d0093064048e0367d31a5f3.png" src="../_images/79b8657181f4c5b86e411f451ea87762a435d4ca7d0093064048e0367d31a5f3.png" />
<img alt="../_images/57684e6779d243c51645d2ebe5a5d963ccc62263d4c2d16c35455e5f84b3ca88.png" src="../_images/57684e6779d243c51645d2ebe5a5d963ccc62263d4c2d16c35455e5f84b3ca88.png" />
</div>
</div>
<p>Comparing the shapiq Kernel Explainer with the marginal Imputer to shaps Kernel explainer with the independent masker on both datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Kernel conditional shapiq to Kernel partition shap on Bike Sharing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Kernel conditional shapiq to Kernel partition shap on California Housing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/19d05ea871cafa50d8c6b050be3e89f2f03c581f626b1ac219f2951e4dd169cd.png" src="../_images/19d05ea871cafa50d8c6b050be3e89f2f03c581f626b1ac219f2951e4dd169cd.png" />
<img alt="../_images/a67d2c2c29cebf513bcdfe0d6e3fa966a3c20f49ff68f28c62f761c1e7f62fd7.png" src="../_images/a67d2c2c29cebf513bcdfe0d6e3fa966a3c20f49ff68f28c62f761c1e7f62fd7.png" />
</div>
</div>
<p>Comparing the shapiq Kernel Explainer with the conditional Imputer to shaps Kernel explainer with the partition masker on both datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Permutation marginal shapiq to Permutation independent shap on Bike Sharing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Permutation marginal shapiq to Permutation independent shap on California Housing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7559309924612fdf4963d062c215a9bec8d036019b02f2c104afe3760b6742e0.png" src="../_images/7559309924612fdf4963d062c215a9bec8d036019b02f2c104afe3760b6742e0.png" />
<img alt="../_images/a667ef049d1fe495c89d722a515903c6286cf9871a6033804599afa9e79c515b.png" src="../_images/a667ef049d1fe495c89d722a515903c6286cf9871a6033804599afa9e79c515b.png" />
</div>
</div>
<p>Comparing the shapiq Permutation Explainer with the marginal Imputer to shaps Permutation explainer with the independent masker on both datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_bike_sharing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_bike_sharing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Permutation conditional shapiq to Permutation partition shap on Bike Sharing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shapiq average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">runtimes_california_housing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="nb">sum</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">errors_california_housing_shap</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shap average&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean squared Error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison Permutation conditional shapiq to Permutation partition shap on California Housing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/715ce01fc3ceeeb18ab03c467787a1344906b06368cfa0cd7df10630d9641a1a.png" src="../_images/715ce01fc3ceeeb18ab03c467787a1344906b06368cfa0cd7df10630d9641a1a.png" />
<img alt="../_images/110ec9e6789e9a9dfa0ebce39031a7345e6249d8476e8f4eabb89be9a760e1d2.png" src="../_images/110ec9e6789e9a9dfa0ebce39031a7345e6249d8476e8f4eabb89be9a760e1d2.png" />
</div>
</div>
<p>Comparing the shapiq Permutation Explainer with the conditional Imputer to shaps Permutation explainer with the partition masker on both datasets.</p>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="3_subset_finding_tutorial.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Greedy Coalition Method</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>